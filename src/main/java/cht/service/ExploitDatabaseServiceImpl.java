/*
 * 版權宣告: FDC all rights reserved.
 */
package cht.service;

import java.io.File;
import java.io.FileNotFoundException;
import java.net.UnknownHostException;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;

import org.springframework.stereotype.Service;
import org.springframework.validation.annotation.Validated;

import cht.connection.ExploitDatabaseMongoDB;
import cht.connection.USCertMongoDB;
import cht.domain.USCertPost;

/**
 * 程式資訊摘要：<P>
 * 類別名稱　　：USCertServiceImpl.java<P>
 * 程式內容說明：<P>
 * 程式修改記錄：<P>
 * XXXX-XX-XX：<P>
 *@author su
 *@version 1.0
 *@since 1.0
 */

@Service
@Validated
public class ExploitDatabaseServiceImpl implements ExploitDatabaseService {

    /* (non-Javadoc)
     * @see javabeat.net.springboot.service.USCertService#save(javabeat.net.springboot.domain.USCertPost)
     */
    public USCertPost save(USCertPost post) {
        // TODO Auto-generated method stub
        return null;
    }

    /* (non-Javadoc)
     * @see javabeat.net.springboot.service.USCertService#getList()
     */
    public List<String> getList() {
        // 
        
        USCertMongoDB db = new ExploitDatabaseMongoDB();
        try {
            return db.getList();
        } catch (UnknownHostException e) {
            e.printStackTrace();
        }
        return new ArrayList<String>();
    }

    /* (non-Javadoc)
     * @see cht.service.USCertService#update(java.lang.String, java.lang.String)
     */
    @Override
    public void update(String id, String chi) {
        USCertMongoDB db = new USCertMongoDB();
        try {
            db.update(id, chi);
        } catch (UnknownHostException e) {
            e.printStackTrace();
        }
    }

    /* (non-Javadoc)
     * @see cht.service.USCertService#submit(java.lang.String, java.lang.String)
     */
    @Override
    public void submit(String id, String chi) {
        USCertMongoDB db = new USCertMongoDB();
        try {
            db.update(id, chi, true);
        } catch (UnknownHostException e) {
            e.printStackTrace();
        }
    }
    
    public String fetchCode(String file) {
        String basePath = "D:/exploit/exploit-database/"; 
        String content = "";
        try {
            content = new Scanner(new File(basePath + file)).useDelimiter("\\n").next();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }
        
        return content;
    }
    
    

}
